-- Generated by Oracle SQL Developer Data Modeler 18.2.0.179.0756
--   at:        2023-12-02 19:36:36 EET
--   site:      Oracle Database 11g
--   type:      Oracle Database 11g



CREATE TABLE author (
    author_id            INTEGER NOT NULL,
    author_firstname     VARCHAR2(20),
    author_lastname      VARCHAR2(20),
    author_birthyear     INTEGER,
    author_dateofdeath   INTEGER,
    gender_id            INTEGER NOT NULL,
    nationality_id       INTEGER NOT NULL
);

ALTER TABLE author ADD CONSTRAINT author_pk PRIMARY KEY ( author_id );

CREATE TABLE book (
    book_id           INTEGER NOT NULL,
    book_title        VARCHAR2(40),
    book_publicdate   DATE,
    book_genre        VARCHAR2(25) NOT NULL,
    book_isbn         VARCHAR2(17),
    book_language     VARCHAR2(20),
    author_id         INTEGER NOT NULL
);

ALTER TABLE book ADD CONSTRAINT book_pk PRIMARY KEY ( book_id,
                                                      book_genre );

CREATE TABLE borrowedbook (
    borrowedbook_id           INTEGER NOT NULL,
    borrowedbook_startdate    DATE,
    borrowedbook_enddate      DATE,
    borrowedbook_isreturned   CHAR(1),
    librarian_id              INTEGER NOT NULL,
    member_id                 INTEGER NOT NULL
);

ALTER TABLE borrowedbook ADD CONSTRAINT borrowedbook_pk PRIMARY KEY ( borrowedbook_id,
                                                                      librarian_id );

CREATE TABLE city (
    city_id     INTEGER NOT NULL,
    city_name   VARCHAR2(30)
);

ALTER TABLE city ADD CONSTRAINT city_pk PRIMARY KEY ( city_id );

CREATE TABLE finerecourd (
    fine_id           INTEGER NOT NULL,
    fine_amount       FLOAT(2),
    fine_reason       VARCHAR2(60),
    fine_status       VARCHAR2(20),
    fine_dateofpaid   DATE,
    member_id         INTEGER NOT NULL
);

ALTER TABLE finerecourd ADD CONSTRAINT finerecourd_pk PRIMARY KEY ( fine_id );

CREATE TABLE gender (
    gender_id     INTEGER NOT NULL,
    gender_name   VARCHAR2(15)
);

ALTER TABLE gender ADD CONSTRAINT gender_pk PRIMARY KEY ( gender_id );

CREATE TABLE inventar (
    inventar_quantity   INTEGER,
    inventar_id         INTEGER NOT NULL,
    borrowedbook_id     INTEGER NOT NULL,
    librarian_id        INTEGER NOT NULL,
    book_id             INTEGER NOT NULL,
    book_genre          VARCHAR2(25) NOT NULL,
    librarybranch_id    INTEGER NOT NULL
);

ALTER TABLE inventar
    ADD CONSTRAINT inventar_pk PRIMARY KEY ( inventar_id,
                                             book_id,
                                             book_genre,
                                             librarybranch_id );

CREATE TABLE librarian (
    librarian_id                INTEGER NOT NULL,
    librarian_firstname         VARCHAR2(20),
    librarian_lastname          VARCHAR2(20),
    librarian_telnumber         VARCHAR2(15),
    librarian_email             VARCHAR2(30),
    librarian_dateofbirth       DATE,
    librarian_dateofhire        DATE,
    librarian_terminationdate   DATE,
    librarybranch_id            INTEGER NOT NULL
);

ALTER TABLE librarian ADD CONSTRAINT librarian_pk PRIMARY KEY ( librarian_id );

CREATE TABLE librarybranch (
    librarybranch_id          INTEGER NOT NULL,
    librarybranch_name        VARCHAR2(40),
    librarybranch_address     VARCHAR2(35),
    librarybranch_telnumber   VARCHAR2(15),
    city_id                   INTEGER NOT NULL
);

ALTER TABLE librarybranch ADD CONSTRAINT librarybranch_pk PRIMARY KEY ( librarybranch_id );

CREATE TABLE member (
    member_id          INTEGER NOT NULL,
    member_status      VARCHAR2(20),
    member_firstname   VARCHAR2(20),
    member_flastname   VARCHAR2(20),
    member_telnumber   VARCHAR2(13),
    member_gender      VARCHAR2(10),
    city_id            INTEGER NOT NULL
);

ALTER TABLE member ADD CONSTRAINT member_pk PRIMARY KEY ( member_id );

CREATE TABLE nationality (
    nationality_id     INTEGER NOT NULL,
    nationality_name   VARCHAR2(50)
);

ALTER TABLE nationality ADD CONSTRAINT nationality_pk PRIMARY KEY ( nationality_id );

CREATE TABLE "User" (
    user_id         INTEGER NOT NULL,
    user_email      VARCHAR2(50),
    user_password   VARCHAR2(150),
    librarian_id    INTEGER NOT NULL
);

CREATE UNIQUE INDEX user__idx ON
    "User" (
        librarian_id
    ASC );

ALTER TABLE "User" ADD CONSTRAINT user_pk PRIMARY KEY ( user_id );

ALTER TABLE author
    ADD CONSTRAINT author_gender_fk FOREIGN KEY ( gender_id )
        REFERENCES gender ( gender_id );

ALTER TABLE author
    ADD CONSTRAINT author_nationality_fk FOREIGN KEY ( nationality_id )
        REFERENCES nationality ( nationality_id );

ALTER TABLE book
    ADD CONSTRAINT book_author_fk FOREIGN KEY ( author_id )
        REFERENCES author ( author_id );

ALTER TABLE borrowedbook
    ADD CONSTRAINT borrowedbook_librarian_fk FOREIGN KEY ( librarian_id )
        REFERENCES librarian ( librarian_id );

ALTER TABLE borrowedbook
    ADD CONSTRAINT borrowedbook_member_fk FOREIGN KEY ( member_id )
        REFERENCES member ( member_id );

ALTER TABLE finerecourd
    ADD CONSTRAINT finerecourd_member_fk FOREIGN KEY ( member_id )
        REFERENCES member ( member_id );

ALTER TABLE inventar
    ADD CONSTRAINT inventar_book_fk FOREIGN KEY ( book_id,
                                                  book_genre )
        REFERENCES book ( book_id,
                          book_genre );

ALTER TABLE inventar
    ADD CONSTRAINT inventar_borrowedbook_fk FOREIGN KEY ( borrowedbook_id,
                                                          librarian_id )
        REFERENCES borrowedbook ( borrowedbook_id,
                                  librarian_id );

ALTER TABLE inventar
    ADD CONSTRAINT inventar_librarybranch_fk FOREIGN KEY ( librarybranch_id )
        REFERENCES librarybranch ( librarybranch_id );

ALTER TABLE librarian
    ADD CONSTRAINT librarian_librarybranch_fk FOREIGN KEY ( librarybranch_id )
        REFERENCES librarybranch ( librarybranch_id );

ALTER TABLE librarybranch
    ADD CONSTRAINT librarybranch_city_fk FOREIGN KEY ( city_id )
        REFERENCES city ( city_id );

ALTER TABLE member
    ADD CONSTRAINT member_city_fk FOREIGN KEY ( city_id )
        REFERENCES city ( city_id );

ALTER TABLE "User"
    ADD CONSTRAINT user_librarian_fk FOREIGN KEY ( librarian_id )
        REFERENCES librarian ( librarian_id );



-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                            12
-- CREATE INDEX                             1
-- ALTER TABLE                             25
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE MATERIALIZED VIEW LOG             0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
